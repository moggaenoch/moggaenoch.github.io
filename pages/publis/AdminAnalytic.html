<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Market Intelligence | Juba Homez</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #f8fafc; color: #1e293b; }
        .chart-container { position: relative; height: 320px; width: 100%; }
        #map { height: 450px; border-radius: 1.5rem; z-index: 1; }
        /* Custom scrollbar for a polished look */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #f1f5f9; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
    </style>
</head>
<body>

    <div class="flex min-h-screen">
        <aside class="w-64 bg-slate-900 text-white hidden lg:flex flex-col sticky top-0 h-screen shadow-2xl">
            <div class="p-6 border-b border-slate-800">
                <h1 class="text-xl font-bold tracking-tight text-blue-400">JUBA HOMEZ</h1>
                <p class="text-[10px] text-slate-500 uppercase tracking-[0.2em] mt-1 font-bold">Intelligence Suite</p>
            </div>
            <nav class="flex-1 px-4 py-6 space-y-1">
                <a href="AdminOverview.html" class="flex items-center space-x-3 p-3 text-slate-400 hover:bg-slate-800 hover:text-white rounded-xl transition">
                    <i data-lucide="layout-dashboard" class="w-5 h-5"></i>
                    <span class="font-medium">Overview</span>
                </a>
                <a href="#" class="flex items-center space-x-3 p-3 bg-blue-600 text-white rounded-xl transition shadow-lg shadow-blue-900/40">
                    <i data-lucide="bar-chart-3" class="w-5 h-5"></i>
                    <span class="font-medium">Analytics</span>
                </a>
                <a href="AdminVerification.html" class="flex items-center space-x-3 p-3 text-slate-400 hover:bg-slate-800 hover:text-white rounded-xl transition">
                    <i data-lucide="shield-check" class="w-5 h-5"></i>
                    <span class="font-medium">Verification</span>
                </a>
            </nav>
        </aside>

        <main class="flex-1 p-6 lg:p-10">
            <header class="mb-10 flex flex-col md:flex-row md:items-center justify-between gap-6">
                <div>
                    <h1 class="text-3xl font-extrabold text-slate-900 tracking-tight">Regional Insights</h1>
                    <p class="text-slate-500 mt-1">Comprehensive analysis of 12+ districts across Juba.</p>
                </div>
                <div class="flex gap-3">
                    <button class="bg-white border border-slate-200 px-4 py-2 rounded-xl text-sm font-semibold text-slate-700 shadow-sm hover:bg-slate-50 flex items-center gap-2">
                        <i data-lucide="share-2" class="w-4 h-4"></i> Share
                    </button>
                    <div class="bg-slate-900 px-4 py-2 rounded-xl text-sm font-semibold text-white shadow-md flex items-center gap-2">
                        <i data-lucide="download" class="w-4 h-4"></i> Export Data
                    </div>
                </div>
            </header>

            <div class="grid grid-cols-1 xl:grid-cols-3 gap-8 mb-10">
                <div class="xl:col-span-2 bg-white p-6 rounded-3xl border border-slate-100 shadow-sm">
                    <div class="flex items-center justify-between mb-6">
                        <div>
                            <h3 class="font-bold text-slate-800 text-lg">Listing Density Map</h3>
                            <p class="text-slate-400 text-xs">Geospatial concentration of available properties.</p>
                        </div>
                        <div class="flex gap-2">
                            <span class="flex items-center gap-1 text-[10px] font-bold text-slate-500 bg-slate-100 px-2 py-1 rounded">
                                <span class="w-2 h-2 bg-red-500 rounded-circle"></span> High Demand
                            </span>
                        </div>
                    </div>
                    <div id="map"></div>
                </div>

                <div class="bg-white p-6 rounded-3xl border border-slate-100 shadow-sm flex flex-col">
                    <h3 class="font-bold text-slate-800 text-lg mb-4">Location Performance</h3>
                    <div class="flex-1 overflow-y-auto pr-2 space-y-3 max-h-[400px]">
                        <div id="leaderboard-container"></div>
                    </div>
                </div>
            </div>

            <section class="grid grid-cols-1 gap-8 mb-10">
                <div class="bg-white p-8 rounded-3xl border border-slate-100 shadow-sm">
                    <div class="flex items-center justify-between mb-8">
                        <div>
                            <h3 class="font-bold text-slate-800 text-xl">Property Acquisition Trends</h3>
                            <p class="text-slate-500 text-sm italic">New listings added across all major districts.</p>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="listingsChart"></canvas>
                    </div>
                </div>

                <div class="bg-white p-8 rounded-3xl border border-slate-100 shadow-sm">
                    <div class="flex items-center justify-between mb-8">
                        <div>
                            <h3 class="font-bold text-slate-800 text-xl">Consumer Feedback Volume</h3>
                            <p class="text-slate-500 text-sm italic">Monthly review frequency per neighborhood.</p>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="reviewsChart"></canvas>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        lucide.createIcons();

        // Comprehensive Data Set
        const locations = [
            { name: 'Gudele', listings: 420, success: 88, lat: 4.852, lng: 31.545, reviews: [45, 70, 60, 95, 120, 140] },
            { name: 'Gurei', listings: 310, success: 74, lat: 4.835, lng: 31.520, reviews: [20, 40, 35, 55, 75, 90] },
            { name: 'Munuki', listings: 285, success: 62, lat: 4.870, lng: 31.560, reviews: [30, 45, 50, 60, 80, 110] },
            { name: 'Atlabara', listings: 240, success: 91, lat: 4.855, lng: 31.590, reviews: [55, 60, 75, 80, 100, 125] },
            { name: 'Tongpiny', listings: 195, success: 85, lat: 4.865, lng: 31.605, reviews: [40, 50, 55, 70, 85, 95] },
            { name: 'Malakia', listings: 180, success: 58, lat: 4.845, lng: 31.585, reviews: [15, 25, 30, 40, 50, 65] },
            { name: 'Hai Mauna', listings: 155, success: 70, lat: 4.860, lng: 31.575, reviews: [10, 20, 25, 35, 45, 55] },
            { name: 'Jebel', listings: 140, success: 65, lat: 4.825, lng: 31.565, reviews: [12, 18, 22, 30, 40, 48] },
            { name: 'Nimra Talata', listings: 125, success: 82, lat: 4.850, lng: 31.595, reviews: [25, 35, 40, 45, 60, 70] },
            { name: 'Rock City', listings: 110, success: 77, lat: 4.820, lng: 31.540, reviews: [8, 15, 20, 25, 35, 42] },
            { name: 'Hai Cinema', listings: 95, success: 89, lat: 4.858, lng: 31.598, reviews: [20, 25, 30, 35, 45, 50] },
            { name: 'Sherikat', listings: 85, success: 52, lat: 4.830, lng: 31.630, reviews: [5, 12, 18, 22, 30, 35] }
        ];

        // Populate Leaderboard
        const container = document.getElementById('leaderboard-container');
        locations.sort((a, b) => b.listings - a.listings).forEach((loc, index) => {
            const colorClass = index === 0 ? 'bg-blue-100 text-blue-600' : 'bg-slate-100 text-slate-600';
            container.innerHTML += `
                <div class="flex items-center justify-between p-3 hover:bg-slate-50 rounded-xl transition cursor-default">
                    <div class="flex items-center gap-3">
                        <div class="w-8 h-8 rounded-lg ${colorClass} flex items-center justify-center text-xs font-bold">${index + 1}</div>
                        <div>
                            <h4 class="font-bold text-slate-800 text-xs">${loc.name}</h4>
                            <p class="text-[10px] text-slate-400">${loc.listings} Listings</p>
                        </div>
                    </div>
                    <div class="text-right">
                        <p class="text-xs font-bold ${loc.success > 80 ? 'text-emerald-600' : 'text-blue-600'}">${loc.success}%</p>
                        <p class="text-[9px] text-slate-400 font-bold uppercase tracking-tighter">Success</p>
                    </div>
                </div>
            `;
        });

        // Map Initialization
        const map = L.map('map', { scrollWheelZoom: false }).setView([4.85, 31.58], 13);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);

        locations.forEach(loc => {
            const intensity = loc.listings / 420;
            L.circle([loc.lat, loc.lng], {
                color: intensity > 0.7 ? '#ef4444' : '#3b82f6',
                fillColor: intensity > 0.7 ? '#ef4444' : '#3b82f6',
                fillOpacity: 0.4,
                radius: 300 + (intensity * 400)
            }).addTo(map).bindPopup(`<b class="font-bold">${loc.name}</b><br>${loc.listings} Properties`);
        });

        // Charts
        const chartStyles = {
            responsive: true,
            maintainAspectRatio: false,
            plugins: { legend: { display: false } },
            scales: {
                y: { grid: { borderDash: [4, 4], color: '#e2e8f0' }, ticks: { font: { size: 10, weight: '500' } } },
                x: { grid: { display: false }, ticks: { font: { size: 10, weight: '500' } } }
            }
        };

        // Listings Bar Chart
        new Chart(document.getElementById('listingsChart'), {
            type: 'bar',
            data: {
                labels: locations.map(l => l.name),
                datasets: [{
                    data: locations.map(l => l.listings),
                    backgroundColor: locations.map((_, i) => i < 3 ? '#2563eb' : '#94a3b8'),
                    borderRadius: 6
                }]
            },
            options: chartStyles
        });

        // Reviews Line Chart (Top 5 for clarity)
        new Chart(document.getElementById('reviewsChart'), {
            type: 'line',
            data: {
                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                datasets: locations.slice(0, 5).map((loc, i) => ({
                    label: loc.name,
                    data: loc.reviews,
                    borderColor: ['#2563eb', '#10b981', '#f59e0b', '#8b5cf6', '#ef4444'][i],
                    tension: 0.4,
                    borderWidth: 3,
                    pointRadius: 0
                }))
            },
            options: { ...chartStyles, plugins: { legend: { display: true, position: 'bottom' } } }
        });
    </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <script src="assets/js/config.js"></script>
  <script src="assets/js/http.js"></script>
  <script src="assets/js/admin.js"></script>
  <script>Admin.wireComingSoon(); Admin.loadBadges(); Admin.loadPendingCounts();</script>
</body>
</html>